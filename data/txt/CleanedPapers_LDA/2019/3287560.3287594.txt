Fairness Under Unawareness Assessing Disparity When Protected Class Is Unobserved Assessing the fairness of a decision making system with respect to a protected class such as gender or race is challenging when class membership labels are unavailable Probabilistic models for predicting the protected class based on observable proxies such as surname and geolocation for race are sometimes used to impute these missing labels for compliance assessments Empirically these methods are observed to exaggerate disparities but the reason why is unknown In this paper we decompose the biases in estimating outcome disparity via threshold-based imputation into multiple interpretable bias sources allowing us to explain when over- or underestimation occurs We also propose an alternative weighted estimator that uses soft classification and show that its bias arises simply from the conditional covariance of the outcome with the true class membership Finally we illustrate our results with numerical simulations and a public dataset of mortgage applications using geolocation as a proxy for race We confirm that the bias of threshold-based imputation is generally upward but its magnitude varies strongly with the threshold chosen Our new weighted estimator tends to have a negative bias that is much simpler to analyze and reason about CONCEPTS Social and professional topics Race and ethnicity Geographic characteristics Applied computing IT governance Law KEYWORDS fair lending disparate impact protected class racial discrimination race imputation probablistic proxy model Bayesian Improved Surname Geocoding INTRODUCTION Models for high stakes decision making have ethical and legal needs to demonstrate a lack of discrimination with respect to protected classes Examples of such decisions include employment and compensation university admissions and sentence and bail setting Another example relevant to the financial services industry is credit decisioning which is a classification problem where these ethical concerns are enshrined in concrete regulatory compliance requirements Credit decisions must be shown to comply with a myriad of federal and state fair lending laws some of which are summarized in protected classes such as race and gender where discrimination on the basis of a customers membership in these classes is prohibited Table summarizes the protected classes defined by the Fair Housing Act FHA and Equal Credit Opportunity Act ECOA Table Protected classes defined under fair lending laws Law FHA ECOA age X color X X disability X exercised rights under CCPA X familial status household composition X gender identity X marital status single or married X national origin X X race X X recipient of public assistance X religion X X sex X X United States of America Assessing fairness with unknown protected class membership When demonstrating that credit decisions comply with these fair lending laws we sometimes run into situations where fairness and bias assessments must be done on populations without knowing their memberships in protected classes because it is illegal or operationally difficult to do so For example credit card and auto loan companies must demonstrate that the way they extend credit is not racially discriminatory yet are not allowed to ask applicants what race they are when they apply for credit can only solicit race and ethnicity information for new members but cannot obtain the same information for existing members Given the lack of secure protocols that permit disparity evaluation with encrypted protected classes disparate impact assessments for these situations have to impute the mostly or entirely missing labels corresponding to the protected class usually by relying on observed proxy variables that can predict class memberships The imputed protected classes are then used by regulators in assessing disparate impact but they are not allowed to be used in decision making Generally any model that imputes the missing protected attribute value based on other observed variables is known as a proxy model and such a model that is based on predicting conditional class membership probabilities is known as a probabilistic proxy model For example for assessing adverse action with regard to race in credit decisions regulators like the Bureau of Consumer Financial Protection BCFP bilistic proxy model to impute the customers unknown race labels They used a naïve Bayes classifier the Bayesian Improved Surname Geocoding BISG method to predict the probability of race membership given the customers surname and address of residence Specifically assuming that surname and location are statistically independent given race BISG uses Bayess rule to compute race membership probabilities from the conditional distributions of surname given race and of location given race as inferred by census data This methodology notably supported a million fine against a major auto loan lender This case generated some controversy in part due to empirical findings that the amount of disparate impact estimated by BISG appears to overestimate true disparities However the cause for this overestimation phenomenon is unknown as is whether overestimation is to be expected always or whether or not underestimation of disparate impact is also possible This observation forms the motivation for our current work which is broadly applicable to any fairness assessment where an unobserved protected class must be imputed using a proxy model The aim is not to criticize the use of proxy models in general but rather to provide a more informed analysis of the statistical biases inherent in any assessment where membership in protected classes must be imputed Main results This paper investigates the bias in estimating demographic disparity Definition when a proxy model is employed standing that the answer will not affect the outcome of the application and that the information is collected for compliance assessment only CFR b reflect the name at time of publication to impute a protected class We present the first theoretical results describing when the use of proxy models can lead to biased estimates of outcome disparity which explains the overestimates observed in the past and also offers insights on the practical use of proxy models More specifically our key contributions are We derive the statistical bias for the commonly used thresholded estimator where a label is assigned only if the proxy model predicts a label with probability exceeding a predefined threshold Definition Theorem We decompose its bias into multiple sources which gives a set of interpretable conditions under which the thresholded estimator can over- or underestimate the outcome disparity We present a new weighted estimator for demographic disparity Definition that uses soft classification based on proxy model outputs as opposed to hard imputation We derive its bias Theorem and find that the weighted estimator has only one bias source We validate our results on a public mortgage data set using geolocation as the sole variable in a proxy model for race We identify the specific source of bias that can account for the overestimation of the thresholded estimator which can explain the overestimation bias of using proxy methods observed in previous literature We discover that the estimation bias is sensitive to the threshold used in class imputation based on the proxy model This shows the intrinsic limitation of the thresholded estimator EVALUATING THE FAIRNESS OF A BINARY DECISION We have three main variables of interest Binary decision Y with Y representing a favorable outcome such as the approval of loan application or college admission offer and Y representing an unfavorable outcome Protected class A such as gender or race often we will write A a for the advantaged group and A b for the disadvantaged group Proxy variable Z a set of covariates taking values z Z used to predict A in a probabilistic proxy model We present only the binary case A ab for simplicity Unless otherwise stated for multiclass A our results generalize straightforwardly to the pairwise outcome disparity between any advantaged group and any disadvantaged group Additional details are given in Appendices B and C Definition The mean group outcome for the group A u is A u where u ab and E is the usual expectation with respect to population distribution Definition The demographic disparity or Calders-Verwer gap is the difference in mean group outcomes between the advantaged and disadvantaged groups A positive demographic disparity means that a higher proportion of the advantaged group A a receive a favorable outcome than the disadvantaged group b ie the disadvantaged group experiences an outcome disparity Demographic disparity is simple to understand and is widely used despite its flaws When the labels for the protected class A are known the demographic disparity can be simply and reliably estimated by the difference of within-group sample means Otherwise a probabilistic proxy model may be used to estimate the probabilities PA a Z and PA b Z of membership to the different groups within A BISG is an example of a probabilistic proxy model where Z is taken to be surname and geolocation and conditional probabilities are estimated using the naïve Bayes methodology The goal of this paper is to quantify the bias in estimating demographic disparity using a proxy model We neglect the estimation bias intrinsic to estimating the proxy model itself so that PA u Z u ab describes the true population distribution of A conditioned on Z and hence the intrinsic uncertainty of predicting A from Z Thresholded estimator In order to introduce the estimators for demographic disparity assume that we have N independent and identically distributed iid samples N i The true membership Ai of the ith sample is unknown but we have access to the probabilistic proxy estimates u u ab i N by simply applying our proxy model to the observed proxy variable The ordinary approach is to predict a single value for class membership Ai Definition Let q membership Ai for the ith unit is Ai a a q b b q NA otherwise where NA stand for an unclassified observation that is excluded from the subsequent outcome disparity evaluation Considering a unit with A a this estimation rule can be summarized pictorially as follows correctly classified incorrectly classified P A where dashed boxes represent correct A A green and incorrect classifications A A red and the middle is unclassified We can use these predicted labels to estimate the mean group outcomes and demographic disparity by mimicking the simple estimator for group sample means difference but imputing A for the unknown A This leads to the following estimator Definition Let Ni be N iid samples Ai N i be the estimated labels according to the thresholding rule in Definition and IS be the indicator function for some set S Then the thresholded estimators for mean group outcomes and demographic Table Lending policy of Example which always accepts high income applicants and never low income applicants Each number in the table cells represents the number of applicants who truly belong to race a or b The percentages in parentheses represent the average loan approval rate in that quadrant True race Neighborhood a b high income i low income ii i Misclassified as race a in high-income neighborhood ii Misclassified as race b in low-income neighborhood disparity are u N i i u u ab a b Weighted estimator The form of the thresholded estimators above shows clearly the use of a hard classification rule Under a probabilistic proxy model this hard classification rule inevitably misclassifies some individuals given the intrinsic uncertainty in classifying the protected class Moreover the threshold rule results in a group of unclassified individuals who are removed from the outcome disparity evaluation To avoid these problems we propose a new estimator that accounts for the soft classification generated by the proxy Definition Let Ni be defined as above Then the weighted estimators for mean group outcomes and demographic disparity are u N i a i a u ab a b T y examples In this part we use two hypothetical toy examples to demonstrate the intuition regarding when the thresholded estimator can overestimate the demographic disparity In both examples we consider evaluating the disparity of loan approval with respect to two races A a and A b However the true race A is unknown so the geolocation Z is used to estimate race Suppose that there are only two neighborhoods where all people live in one neighborhood have high income and all people live in the other neighborhood have low income We further assume that the high-income neighborhood is primarily occupied by the advantaged group a and the low-income neighborhood is primarily occupied by the disadvantaged group b Therefore the thresholding rule with q classifies all people living in the high-income neighborhood as the advantaged group ie A a and all people living in the low-income neighborhood as the disadvantaged group ie A b Table Lending policy of Example with affirmative action that favors the disadvantaged group over the advantaged group at any given income level True race Neighborhood a b high income i low income ii i Misclassified as race a in high-income neighborhood ii Misclassified as race b in low-income neighborhood Example Consider an extreme lending policy all people with high income get their loans approved while all people with low income are rejected no matter what their races are See Table for the illustration Simple calculations show that the true demographic disparity demographic disparity The reason for the overestimation is that the race proxy is correlated with the loan approval outcome because of the dependence between geolocation and socioeconomic status people who live in the neighborhood primarily occupied by the advantaged group are also more likely to get loan approval because they have relatively high socioeconomic status eg high income in this example These people are classified as advantaged group because their neighborhoods are associated with high probability of belonging to the advantaged group As a result the thresholding rule misclassifies people who are from the disadvantaged group but get loan approval as the advantaged group In this way the thresholding rule leads to underestimates of the loan acceptance rate of the disadvantaged group Analogously the thresholding rule leads to overestimates of the loan acceptance rate of the advantaged group because it misclassifies people from the advantaged group but not likely to get loan approval as the disadvantaged group Consequently the misclassification of the protected attribute is dependent with the outcome which ultimately leads to the overestimation of demographic disparity The dependence between the misclassification and the outcome results from the inter-geolocation outcome variation the socioeconomic status race proxy probabilities ie race ratios and loan acceptance rates vary across different neighborhoods such that the favorable outcome is positively correlated with the probability of belonging to the advantaged group Example Now consider a hypothetical lending policy with affirmative action that approves the disadvantaged group with higher rate than the advantaged group with the same income level But overall people with high income are still more likely to be accepted See Table for a concrete example Simple calculations show that the true demographic disparity disadvantaged group overall has lower chance to get loan approval due to their population concentration in the low-income neighborhood However the thresholded estimator gives that overestimates the demographic disparity The reason for the overestimation is that the the disadvantaged group have higher approval rate than their neighbors from the advantaged group As a result misclassifying part of the disadvantaged group as the advantaged group raises the average approval rate for the advantaged group Similarly misclassifying part of the advantaged group as the disadvantaged group lowers down the average approval rate for the disadvantaged group Consequently the misclassification of the protected attribute is also dependent with the outcome and ultimately leads to overestimation of demographic disparity In contrast to Example the dependence between the misclassification and the outcome results from the intra-geolocation outcome variation people from different protected groups living in the same locations have different chance of getting the favorable outcome In both examples the protected attribute misclassification made by the thresholding rule is not uniformly at random Instead the misclassification shows systematic pattern with respect to the outcome either due to the inter-geolocation outcome variation Example or intra-geolocation outcome variation Example In Section we will formalize the main intuition in these two examples and show that the interplay of the two bias sources captured by these two examples determines the overestimation or underestimation of the thresholded estimator In Section we will further identify the specific bias source that accounts for the estimation bias of the thresholded estimator in a mortgage data set BIAS IN THRESHOLDED AND WEIGHTED ESTIMATORS In this section we derive the asymptotic biases for the thresholded estimator and weighted estimator for demographic disparity We also provide some interpretable sufficient conditions under which these two estimators overestimate or underestimate the demographic disparity Weighted estimator Theorem Let A be a binary protected class with values a and b The bias of the weighted estimator in Definition for demographic disparity in is a b where as N the biases in the weighted estimators for the mean group outcomes u for u ab converge almost surely to u as Z PA u We omit the as almost sure notation later for brevity Corollary If Y is independent of A conditionally on Z then the weighted estimator for demographic disparity is asymptotically unbiased If Y is independent of A conditionally on Z then the advantaged group and disadvantaged group with the same Z values are equally treated in terms of the average outcome Nevertheless this does not contradict the existence of overall disparity against the disadvantaged group in terms of the unconditioned average outcome as an example of Simpsons paradox The conditional independence assumption required by Corollary is trivially satisfied if Y is the output of some function X and Z includes the input features X since Y is now determined entirely by Z Such a situation arises naturally when Y is the output of machine learning algorithms In the Appendix C we show a semi-synthetic example based on the mortgage dataset where the weighted estimator is asymptotically unbiased when the proxy model is well constructed so that the conditional independence assumption is satisfied However this conditional independence assumption may not hold in practice and the weighted estimator may be biased Consider the example of loan application with race proxy based on geolocation If within most locations the affirmative action described in Example is present ie the disadvantaged group is more likely to get a loan than their neighbors from the advantaged group then Y covaries negatively with a and positively with b conditionally on Z z for most values of z Z which implies that the weighted estimator overestimates the demographic disparity On the contrary if within most locations the advantaged group is more likely to get loan than their neighbors belonging to the disadvantaged group then Y covaries in the exact opposite way implying that the weighted estimator underestimates the demographic disparity Overall the estimation bias of the weighted estimator depends on the intra-geolocation variation of the loan application outcome Thresholded estimator Before stating the asymptotic bias for the estimator we define the following terms for u ab u PA u Z PA u Z u u PA u Z u PA u Z u where q is the threshold used for estimating race and is the class opposite to u ie b if u a and a if u b u measures the outcome mean discrepancy for two different protected groups within the same proxy probability range and u measures the outcome mean discrepancy across different proxy probability ranges for the same protected group Consider the example of loan application with race proxy based on geolocation In this example u measures the loan approval disparity between two race groups who live in locations that are primarily occupied by one of these two races in terms of the threshold q In contrast u measures the loan approval rate disparity between people belonging to a race who live in locations that are primarily occupied by this race group and people belonging to this race who live in locations that are less occupied by this race Therefore u roughly characterizes the intra-geolocation variation of loan outcome and u roughly characterizes the inter-geolocation variation of loan outcome Theorem Let A be a binary protected class with values a and b The bias for the thresholded estimator in Definition is a b and as N for u ab and ab as the class opposite to u u u where PA u A A u PA u A u A u and PA u A A u Here A u means that A or A NA The generalization to multiclass A is straightforward and in Appendix C we show that the bias formula in Theorem for binary protected class capture the main effects of the bias for multiclass A Theorem shows that the occurrence of overestimation or underestimation depends on complex interplay of the terms In the following corollary we provide the simplest set of sufficient conditions for the overestimation and underestimation to demonstrate the main intuition Corollary Suppose a i b ii a and iii b iv and at least one inequality holds strictly Then in the limit N a b and ie the thresholded estimator overestimates the demographic disparity Conversely let i a ii b iii a and iv b and at least one inequality holds strictly Then in the limit N a b and ie the thresholded estimator underestimates the demographic disparity The conditions are demonstrated in Figure Conditions iii exactly formalize the intuition captured by Example In our loan application example using a geolocation-based race proxy these two conditions capture the intra-geolocation outcome variation on average higher proportion of disadvantaged group b receive the favorable outcome than the advantaged group a among all the geolocations that are primarily occupied by one race in terms of the threshold q The conditions exactly formalize the intuition captured by Example They characterize the dependence between the decision outcome and the proxy probability conditionally on the protected attribute Specifically condition iii holds when the decision outcome is positively correlated with the probability of belonging to the advantaged group while condition iv holds when the decision outcome is negatively correlated with the probability of belonging to the disadvantaged group conditionally on the true protected attribute In the example of loan application with race proxy based on geolocation geolocation is correlated with both race ratio and socioeconomic status eg income FICO score etc locations that are primarily occupied by the advantaged racial groups tend to be associated with relatively higher socioeconomic status while locations that are primarily occupied by the disadvantaged correctly classified incorrectly classified A a favored mean outcome disfavored mean outcome advantaged group Figure Illustration of conditions in Corollary illustrating the complex interplay between membership in a protected class A and outcome Y that give rise to overestimated demographic disparity using the thresholded estimator of Definition The horizontal axes show PA a Z the probability that a probabilistic proxy model predicts membership in the advantaged group a Dashed boxes represent correct A A green and incorrect classifications A A red from the thresholded estimated membership rule of Definition with the interval always unclassified Solid bars represent favored purple and disfavored mean outcomes yellow racial groups tend to be associated with relatively lower socioeconomic status As a result people who live in locations dominant by the advantaged racial group are assigned with high probability of belonging to the advantaged group and they are more likely to get approved in loan application because of relatively higher socioeconomic status Conversely the loan approval is negatively correlated with the probability of belonging to disadvantaged groups This example demonstrates that are likely to hold when the predictors Z are also strongly correlated with the decision outcome eg the geolocation is correlated with the loan approval because of the socioeconomic status disparities across different geolocations The following corollary shows that have effects with different magnitudes on the overestimation bias Corollary Let A be a binary protected class with values a and b For u ab and as the class opposite to u the quantities in Theorem are related in the following way i if and only if PA u A u PA A u ii if and only if PA u PA u Thus if the conditions and both hold then and Condition holds as long as the proxy model is reasonably predictive of the true protected class Condition usually holds for the thresholded estimated membership Definition when a high threshold q is used a fairly high fraction of observations are unclassified under the thresholded estimation rule with high threshold q so the fraction of observations classified into one protected class is usually lower than the fraction of observations actually belonging to that protected class Therefore when a high threshold q is used usually conditions contribute more to the overestimation bias than iii As a result even if iii are violated as long as hold the thresholded estimator is still very likely to overestimate demographic disparity In contrast when a low threshold is used the difference between PA u PA u is usually smaller and thus is also smaller In this case iii and may have comparable contribution to the estimation bias In Section we will verify these facts by using different thresholds on the mortgage dataset NUMERICAL RESULTS Analysis of bias terms in synthetic data In this part we simulate an example where geolocation is used to construct proxy for race We use this example to demonstrate different sources of overestimation and underestimation bias of the weighted estimator and the thresholded estimator Experimental setup We consider race as the unknown protected attribute A with A a being the advantaged racial group b being the disadvantaged racial group Suppose there are three different neighborhoods Z z z z where the proportions of people belonging to the advantaged group are respectively These proportions are in turn the race proxy probabilities For example all people who live in the neighborhood z are assigned with PA a Z z PA b Z z as their race proxy If we apply the thresholded estimation rule with q the estimated races for people living in neighborhoods tracts are Z z Z z Z z A b NA a We assume that geolocation is strongly correlated with peoples income X EX Z z EX Z z EX Z z Therefore z can be considered as the low-income tract where the proportion of people belonging to the disadvantaged group is high PA b Z z z can be considered as middle-income tract where the proportions of people belonging to the advantaged group and the disadvantaged group are equal PA a Z z PA b Z z and z can be considered as high-income tract where the proportion of people belonging to the advantaged group is also high PA a Z z The decision outcome Y is loan approval which we assume solely depends on the income X we simulateY according to PY X with Thus people with higher income are more likely to get approved Y Here controls the extent to which loan approval Y depends on income X Since income X solely depends on geolocation Z indirectly controls the dependence of the outcome Y on geolocation Z and thus on the corresponding race proxy probabilities PA a Z PA b Z In each experiment we set the total population size of neighborhoods z z z to be and respectively Each experiment is repeated times and the average estimated demographic disparity from the thresholded estimator the weighted estimator and using the true race is shown in Figure D em ra ph d is pa rit y Experiment d Te v al l Experiment d c db a d thresholded estimator true weighted estimator q l Figure Top row performance of the thresholded red circles and weighted blue triangles estimators of demographic disparity in Experiments a and c relative to the true demographic disparity black line Bottom row values of the terms a b a and b in Corollary in Experiments b and d showing their contributions to the bias Shown in light gray is the confidence interval within two standard deviations averaged over simulations which in all cases is comparable to the width of the plotted lines Experiment The income is normally distributed according with mean value depending on both geolocation and race Z z Z z Z z A a d d d A b d d d where d controls the discrepancy of income X between the two race groups within the same geolocation We fix and vary d from to which indirectly varies the magnitude of intra-geolocation decision outcome variation between the two races By construction d should affect only the ab in iii Experiment The income is normally distributed according to with the mean value depending on only geolocation Z z Z z Z z In other words people with different races within the same geolocation have the same income distribution and thus the same decision outcome distribution Therefore there is no intra-geolocation decision outcome variation between the two races As a result when we vary from to only inter-geolocation outcome variation changes which affects ab in conditions Figure b shows that in Experiment only a and b vary strongly with d so they are largely responsible for the bias observed in Figure a When d the disadvantaged group have comparatively higher incomes and are thus more likely to be approved in loan application This implies that conditions iii hold and therefore result in overestimation bias for the thresholded estimator Furthermore Y covaries negatively with a and positively with b conditionally on Z also resulting in an overestimation bias for the weighted estimator When d however conditions iii are violated The terms a and b start to counteract overestimation bias thus the overestimation bias decreases with d Furthermore Y now covaries positively with a and negatively with b also resulting in an underestimation bias for the weighted estimator Figure d shows that in Experiment only the terms a and b vary strongly with so these terms are responsible for the variation observed in the thresholded estimator in Figure c As increases both a and b increase along with the overestimation bias of In contrast the weighted estimator is unbiased because the income distribution does not depend on race and so Y is independent with a and b conditionally on Z While presented only for the particular choices of for Experiment and d for Experiment the observation of which terms vary strongly with d and hold true for quite a few different choices Estimation biases in the HMDA mortgage data set with geolocation proxy for race In this section we use the public HMDA Home Mortgage Disclosure Act data set bias when using a probabilistic proxy for race This data set contains mortgage loan application records in the US for which the geolocation state county and census tract self-reported race/ethnicity and loan origination outcome were reported and has been used in the literature to evaluate the BISG race proxy We use the loan data for the years consistent with We denote Y if a loan application was approved or originated and Y if it was denied The final sample contains around million observations with non-missing geolocation race and loan origination outcome information We consider a race proxy based only on geolocation as the public data set is anonymized and omits surnames This proxy is derived from the racial and ethnic composition of the US population that is over years of age using the census tracts of the decennial census and API Asian or Pacific Islander in census tract Autauga County Alabama are respectively according to the census This quadruple is assigned to all applicants from this census tract as their race proxy This probabilistic proxy while different from BISG is nevertheless sufficient to demonstrate the general result regarding disparity estimation bias in Section We present results for Hispanic white and black subpopulations in this section and defer the result for API to the Appendix Estimation bias of thresholded estimator and weighted estimator In Figure we show the estimation bias of the thresholded estimator with different thresholds and the weighted estimator Clearly the described in Black Hispanic White Race A cc ta nc e R at e E st im at io n B s White Black White Hispanic Race Pair D em ra ph D is pa rit y E st im at io n B s Method Thresholding Thresholding Thresholding Weighted Figure Left estimation biases of loan acceptance rates for different races in the HMDA data set of Section using the thresholded estimator for mean group outcome q from Definition as well as the weighted estimator from Definition relative to the true mean group outcome calculated using the actual race labels Right estimation biases of demographic disparity between pairs of races using the thresholded estimator from Definition and weighted estimator from Definition relative to the true demographic disparity calculated using the actual race labels White Black White Hispanic i ii iii iv i ii iii iv Conditions Te V al Method Thresholding Thresholding Thresholding Figure The values of the terms a b a and b in Corollary for the mortgage data set of Section for thresholds q and Negative values demonstrate partial violation of the conditions of Corollary thresholded estimator underestimates the loan acceptance rate of black and Hispanic groups but it estimates the loan acceptance rate for White group accurately As a result the thresholded estimator overestimates the demographic disparity Moreover the overestimation bias tends to decrease as the threshold q decreases In contrast the weighted estimator displays the opposite performance and underestimates the demographic disparity Bias source of thresholded estimator Figure shows the conditions Only iv strictly holds meaning that people from the disadvantaged group Hispanic or black living in census tracts where their race ratio exceeds the corresponding classification threshold have lower average loan acceptance rate than people from the disadvantaged group living in census tracts where their race ratio is not as high as the classification threshold This captures the inter-geolocation outcome variation the loan approval is negatively Black White Race C C Black White Race P A u P A u Method Thresholding Thresholding Thresholding Figure Left the difference between the terms and in Theorem for races u black or white and thresholds q and for estimating the race labels according to the thresholded rule of Definition As q increases is increasingly larger than and thus the u terms contribute more to the estimation bias than the u terms Right difference between the probabilities of the true and estimated race labels PA u PA u As q increases from to the proportion of unclassified samples increases from to which causes PA u to decrease drastically As a result increases due to Corollary correlated with the disadvantaged group prevalence across the geolocations In Example we give a reason why loan acceptance is correlated with the race proxy probabilities geolocation is correlated with both race proportions ie race proxy probabilities and socioeconomic status eg income FICO score etc that affects loan approval In Appendix C we validate that such correlations are indeed obvious in the mortgage data set In contrast to conditions iv conditions iii are strictly violated and condition iii is slightly violated However the thresholded estimators still have overestimation bias because iii iv have dominant effects as shown in Figure Moreover as the threshold q increases conditions start to dominate increasing the overestimation bias Nevertheless the apparent reduction of overestimation bias when using lower threshold does not mean that using lower threshold is better in practice Instead the reduction of overestimation bias is the consequence of delicate counterbalance between the two opposing bias sources the violation of conditions iii contributes to underestimation bias and the conditions contribute to overestimation bias Thus the smaller bias from using a lower threshold is not a robust finding For example for the experiments in Section changing the threshold from to does not affect either the race imputation result or the demographic disparity estimation bias This reflects the intrinsic complexity of the thresholded estimator In summary according to Corollary the fact that the thresholded estimation rule for race excludes many unclassified examples makes the overestimation predominantly be determined by the inter-geolocation outcome variation captured by conditions iii iv especially when the threshold q is very high Moreover strong racial segregation and socioeconomic status disparities across different geolocations make condition iii or iv if not both very Covariance being Hispanic and being accepted C ar nc e b ng hi te a nd b ng a cc te d Covariance being Black and being accepted e e e e count Figure The population distribution across different combinations of within-census-tract-covariances between the loan acceptance and the membership to advantaged group or the membership to disadvantaged group The red numbers in each quadrant represents the proportion of people who live in census tracts with the corresponding covariance combination likely to hold As a result the thresholded estimator tends to overestimate the demographic disparity especially when high threshold is used Since BISG also uses geolocation for race estimation the reported overestimation bias of using thresholded estimator with BISG should be at least largely if not all due to the same reason Moreover the estimation bias of thresholded can be very sensitive to the threshold value because the threshold value influences the interplay of the bias sources in This reflects the intrinsic limitation of the thresholded estimator Bias source of the weighted estimator Figure shows the distribution of population who live in census tracts with different combinations of aY Z and bY Z with a representing white and b representing black or Hispanic Theorem implies that the upper left quadrants account for the underestimation bias of weighted estimator for demographic disparity as these quadrants contain all census tracts where the loan acceptance is positively correlated with membership to the advantaged group aY Z while negatively correlated with the membership to the disadvantaged group bY Z Figure shows that the majority of people live in census tracts falling in the upper left quadrants In other words most people live in census tracts where white people have a higher average loan approval rate than their black or Hispanic neighbors This explains the underestimation bias of the weighted estimator since the estimation bias of the weighted estimator is solely determined by the intra-geolocation outcome variation according to Theorem Summary The empirical results show that our theoretical analysis provides convincing explanations for the observed estimation bias of the thresholded estimator and the weighted estimator We show that the bias sources of the weighted estimator and the thresholded estimator are very different the bias of the weighted estimator is solely determined by the intra-geolocation variation and the bias of the thresholded estimator is determined by both inter-geolocation variation and intra-geolocation variation When high threshold is used the inter-geolocation variation dominates In the mortgage dataset we show that the racial segregation socioeconomic status outcome disparity pattern with respect to geolocation make the thresholded estimator tend to overestimate the demographic disparity and the weighted estimator tend to underestimate the demographic disparity This explains the overestimation bias of the thresholded estimator with BISG reported by previous literature Moreover our results show that the estimation bias of thresholded estimator is sensitive to the threshold because of complex interplay of different bias sources As a result the observed estimation bias pattern in one setting may hardly generalize to other settings In contrast the weighted estimator only has one bias source and is thus easier to reason about CONCLUSIONS This paper presents the first theoretical analysis of bias in outcome disparity assessments using a probabilistic proxy model for the unobserved protected class In Theorem we derived the bias of a thresholded estimator Definition that has been described in the literature We also gave sufficient conditions in Corollary to understand when this methodology is biased and to what extent Our theoretical analysis is valid whenever a proxy model is used with a thresholded estimator to impute protected class membership and is thus consistent with previous studies that had observed an overestimation bias of the thresholded estimator based on BISG When applied to the public HMDA mortgage dataset with geolocation as the sole proxy for race membership Section we found that the estimation bias of the thresholded estimator depends on the complex interaction of multiple different biases producing a strong sensitivity to the precise value of the threshold used Further studies will be needed to demonstrate the robustness of this numerical finding particularly when using other proxy models and other measures of fairness Nevertheless our work signals caution for choosing the ad hoc thresholds which are used in practice as without the ground truth labels we are unable to determine the optimal choice of threshold To alleviate the theoretical challenges of the thresholded estimator we also proposed a weighted estimator Definition which propagated the uncertainty resulting from the probabilistic proxy onto the final estimand We found that the estimation bias of this weighted estimator has only one bias source arising from the loan approval discrepancy between difference races within the same geolocation which led to an overall underestimate As the behavior of this estimators bias is simpler to reason about we believe that the weighted estimator may be a useful new method to incorporate into outcome disparity evaluations when proxy models are used especially if the sign of estimation bias can be determined with external knowledge