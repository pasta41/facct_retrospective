The Disparate Equilibria of Algorithmic Decision Making when Individuals Invest Rationally The long-term impact of algorithmic decision making is shaped by the dynamics between the deployed decision rule and individuals response Focusing on settings where each individual desires a positive classification including many important applications such as hiring and school admissions we study a dynamic learning setting where individuals invest in a positive outcome based on their groups expected gain and the decision rule is updated to maximize institutional benefit By characterizing the equilibria of these dynamics we show that natural challenges to desirable long-term outcomes arise due to heterogeneity across groups and the lack of realizability We consider two interventions decoupling the decision rule by group and subsidizing the cost of investment We show that decoupling achieves optimal outcomes in the realizable case but has discrepant effects that may depend on the initial conditions otherwise In contrast subsidizing the cost of investment is shown to create better equilibria for the disadvantaged group even in the absence of realizability CONCEPTS Computing methodologies Machine learning Applied computing Law social and behavioral sciences Economics KEYWORDS fairness machine learning dynamics statistical discrimination INTRODUCTION Automated decision-making systems that rely on machine learning are increasingly used for high-stakes applications yet their long-term consequences have been controversial and poorly understood On one hand deployed decision making models are updated periodically to assure high performance on the target distribution On the other hand deployed models can reshape the underlying populations thus biasing how the model is updated in the future This complex interplay between algorithmic decisions individual-level responses and exogeneous societal forces can lead to pernicious long term effects that reinforce or even exacerbate existing social injustices Harmful feedback loops have been observed in automated decision making in several contexts including recommendation systems predictive policing admission decisions and credit markets These examples underscore the need to better understand the dynamics of algorithmic decision making in order to align decisions made about people with desirable long-term societal outcomes Automated decision-making algorithms rely on observable features to predict some variable of interest In a setting such as hiring decision making models assess features such as scores on standardized tests resume and recommendation letters to identify individuals that are qualified for the job However equally qualified people from different demographic groups tend to have different features due to implicit societal biases eg letter writers describe competent men and women differently gaps in resources eg affluent students can afford different extra-curriculars and even distinct tendencies in self-description eg gender can be inferred from biographies Therefore a models ability to identify qualified individuals can widely vary across different groups The deployed models ability to identify qualified members of a group affects an individuals incentive to invest in their qualification This is because ones decision to acquire qualification not observed directly by the algorithm comes at a cost Moreover individuals that are identified by the model as qualified whether or not they are truly qualified receive a reward Consequently people invest in acquiring qualifications only when their expected reward from the assessment model beats the investment cost Rational individuals are aware that upon investing they would develop features that are similar to those of qualified individuals in their group so they gauge their own expected reward from investing by the observed rewards of their group If qualified people from one group are not duly identified and rewarded fewer people from that group are incentivized to invest in qualifications in the future This reduces the overall fraction of qualified people in that group or the qualification rate As the assessment model is updated to maximize overall institutional profit on the new population distribution it may perform even more poorly on qualified individuals Strong group identification effects can also be seen in empirical studies from a group with relatively low qualification rate further reducing the groups incentive to invest To understand and mitigate the challenges to long-term welfare and fairness posed by such dynamics we propose a formal model of sequential learning and decision-making where at each round a new batch of individuals rationally decide whether to invest in acquiring qualification and the institution updates its assessment rule a classifier for assessing and thus rewarding individuals We study the long-term behavior of these dynamics by characterizing their equilibria and comparing these equilibria based on several metrics of social desirability Our model can be seen as an extension of Coate and Loury s widely cited work to explicitly address heterogeneity in observed features across groups While Coate and Loury s model focuses on a single-dimensional feature space ie scores and assessment rules that act as thresholds on the score our model considers general possibly high-dimensional feature spaces and arbitrary assessment rules which are typical in high-stakes domains such as hiring and admissions We nd that two major obstacles to obtaining desirable long-term outcomes are heterogeneity across groups and lack of realizability within a group Realizability the existence of a near perfect way to assess qualifications of individuals from visible features leads to equilibria that are near optimal on several metrics such as the resulting qualification rates their uniformity across groups and the institutions utility We study near realizability and the lack thereof in Sections and respectively Heterogeneity across groups ie lack of a single assessment rule that perfectly assesses individuals from all groups necessitates trade-offs in the quality of equilibria across different groups We study heterogeneity as well as interventions for mitigating its negative effects in Section In Section we empirically study a more challenging setting where the groups are heterogeneous as well as highly non-realizable via simulations with a FICO credit score dataset that has been widely used for illustration in the algorithmic fairness literature Interventions To mitigate the aforementioned trade-offs we consider two common interventions decoupling the decision policy by group and subsidizing the cost of investment especially when the cost distribution inherently differs by group Our model of dynamics sheds a different light on these interventions complementary to previous work We show that decoupling using group-specific assessment rules achieves optimal outcomes when the problem is realizable within each group but can significantly hurt certain groups when the problem is non-realizable and there exist multiple equilibria after decoupling In particular decoupling can hurt a group with low initial qualification rate if the utility-maximizing assessment rule for a single group is more disincentivizing to individuals than a joint assessment rule thereby reinforcing the status quo and preventing the group from reaching an equilibrium with higher qualification rate We also study subsidizing individuals investment cost eg subsidizing tuition for a top high school especially when the cost distribution is varied across different groups We nd that these subsidies increase the qualification rate of the disadvantaged group at equilibrium regardless of realizability We note that our subsidies which affect the qualification of individuals directly are different than those studied under strategic manipulation that involve subsidizing individuals cost to manipulate their features Y X A Figure Causal graph for the individual investment model The individual intervenes on the node for qualification Y this corresponds to which then affects the distribution of their features X depending on the group A without changing the underlying qualification eg subsidizing SAT exam preparation without changing the students qualification for college and could have adverse effects on disadvantaged groups Instead our theoretical endings resonates with extensive empirical work in economics on the effectiveness of subsidizing opportunities for a disadvantaged group to directly improve their outcomes such as moving to better neighborhoods to access better educational and environmental resources Related work Our work is related to a rich body of work on algorithmic fairness in dynamic settings strategic classification as well as statistical discrimination in economics We present a detailed discussion of the similarities and differences in Section A DYNAMIC MODEL OF ALGORITHMIC DECISION MAKING In this section we introduce a model of automated decision making with feedback We rst introduce the notation used throughout the paper and then describe the details of the interactions between individuals and an institution and the resulting dynamical system Notation We consider an instance space X where X X denotes the features of an individual that are observable by the institution We also consider a label space Y where Y indicates that an individual has the qualifications desired by the institution otherwise We denote the set of all protected/group attributes by A where A A denotes an individuals protected attribute We denote the group proportions by na B PA a for all a A Furthermore we denote the qualification rate in group a A by a B PY A a An individual from group A a who has acquired label Y to become qualified or not receives features X distributed according to x Y A a This is illustrated in Figure We also consider a set of parameters that are used for assessing qualifications We use Y Y parameterized by to denote the assessed qualification of an individual We assume that Y only depends on the features X which may or may not contain A or its proxies In later sections we will also discuss interventions that allow us to use Y that explicitly depends on group membership A We respectively define the true positive rate and false positive rate This can be seen as the individual performing a do-intervention on Y see eg Thus we may write for making the decision to acquire qualifications Our model Figure assumes that Y is not the child of any node so we have P P Y Hence we drop the do-operator whenever we condition on Y of on group a A by tpr PY Y A a and fpr PY Y A a Model Description Individuals Rational Response We consider a setting where an individual decides whether to acquire qualifications that is to invest in obtaining label Y prior to observing their feature X The decision to acquire qualification depends on the qualification assessment rule currently implemented by the institution We will characterize the groups qualification rates as the best-response to by function bra aA To get label Y an individual has to pay a cost C In any group C is distributed randomly according to the cumulative distribution function CDF G After deciding whether to acquire qualifications an individual gets features X and is assessed by An individual from any group and regardless of actual qualification receives a payoff of if they are assessed to be qualified and payoff of otherwise Therefore the expected utility an individual from group a receives from acquiring qualification Y is Y A a C tpr C whereas the expected utility for not acquiring the qualification is Y A a fpr Given the qualification assessment parameter an individual from group a acquires qualification if and only if the benefit outweighs the costs that is tpr fpr C Then each groups qualification rate as a function of a qualification assessment parameter is bra B PY A a PC tpr fpr G tpr fpr Institutions Rational Response We consider an institution that has to choose a qualification assessment parameter for accepting individuals to maximize its utility We assume that the institution gains p tp for accepting a qualified individual and loses c FP for accepting an unqualified individual Then the expected utility of the institution for applying parameter is p tp PY Y c FP PY Y p tp X aA tpr ana X aA c FP fpr a na This illustrates that the utility maximizing parameter is a function of a aA ie the rate of qualification in each group We denote this function by defined as follows argmax p tp X aA tpr ana X aA c FP fpr a na To ensure the above object and the resulting dynamics are welldened when multiple parameters achieve the optimal utility we assume that is uniquely defined using a fixed and welldened tie-breaking function For the rest of this work unless otherwise stated we assume that the distribution of costs G is the same for every group In Section and we will consider the implications of having different cost distributions by group Throughout this paper we assume that the institution has exact knowledge of many quantities such as tpr fpr and na In a nutshell we assume that we have infinitely many samples from the underlying distributions We discuss this further in Section and leave the finite sample version of these results to future work Although we choose not to focus on game-theoretical aspects in this work we note that our model can be thought of as a large game or a game with a continuum of players Dynamical System and Equilibria We are primarily interested in the evolution of qualification rate over time Given a current rate of qualification the assessment parameter used by the institution in the next step is which in turn leads to a qualification rate of in the next step Therefore we define a dynamical system for a given initial state such that at time t we are in state t t where We say that the aforementioned dynamical system is at equilibrium if Equivalently we are at an equilibrium if limn n is well-defined for some where n is an n-fold composition of We call such values of equilibria or equivalently fixed points of In general may have multiple fixed points that demonstrate different characteristics We therefore compare the fixed points of on several metrics of societal importance Stability We say that an equilibrium is stable if there is a non-zero measure set of initial states for which limn n In particular if there exists a neighborhood around such that all points converge to under the dynamics we say that is locally stable As such stable fixed points are robust to small perturbations in the qualification rate which can occur due to random measurement errors qualification Rate of Group a Recall that the qualification rate a is the fraction of individuals in group a who invested in qualifications Since it is more desirable to have a high qualification rate in each group we may compare equilibria based on a We refer to G as the optimal qualification rate in group a which is the maximum achievable qualification rate corresponding to the perfect assessment rule Balance We may be interested in equilibria where the qualification rate is similar across groups that is to prioritize equilibria with smaller max a a When this quantity is we say that is fully balanced Institutional utility We may compare equilibria based on their corresponding institution utility Examples From the Real World Let us instantiate our model in the setting of two important applications from the real world College Admissions Consider the college admission setting where X corresponds to the features that the college can observe eg a candidates test scores and letters of recommendation Y indicates whether the candidate meets the qualifications required to succeed in the program C is the cost of investing in the qualifications eg the money and opportunity cost of studying or taking additional courses to obtain the required qualifications A If group a has a group-specific cost distribution Ga then we refer to Ga as the optimal qualification rate in group a candidate from group a will develop features from distribution x Y A a where indicates a qualified candidate The differences in the feature distribution between groups can be attributed to several factors such as resources that are available to different groups eg letters of recommendations for qualified female and male candidates often emphasize different traits is the decision parameter used by the college eg Y when the candidate has SAT score of and an excellent recommendation letter The college accepts applicants by trading o between the utility gain p tp of admitting qualified candidates and utility cost c FP of admitting an unqualified candidates The candidate is incentivized to acquire the qualifications for the college based on the long term benefit described in Equation that depends on their expected gain from completing a college degree and how likely it is to be admitted to college for a qualified or unqualified member of the group the candidate belongs to Hiring Consider the hiring setting where X corresponds to the features that the term can observe eg a candidates indicates whether the applicant meets the qualifications required by the term eg having the required knowledge and the ability to work in a team C is the cost of acquiring the qualifications required by the term eg the monetary and opportunity cost of acquiring a college degree or working on a team project Parameter is the hiring parameter used by the term eg Y when the applicant has a software engineering degree and two years of experience The term accepts candidates according to utility maximization involving p tp the profit from hiring a qualified candidate and c FP the cost of hiring an unqualified candidate eg the loss in productivity or the the cost to replace the employee The candidate is incentivized to acquire the qualifications for the job based on factors including their expected salary and how likely it is to be hired by the term given how the term has hired qualified or unqualified candidates from the group the candidate belongs to We also consider a stylized example of lending in Section IMPORTANCE OF NEAR REALIZABILITY We start our theoretical investigation of dynamic algorithmic decision making with the classical model of realizability In the theory of machine learning a distribution is called realizable if there is a decision rule in the set whose error on the distribution is Analogously we call a setting realizable when there is a decision rule opt that perfectly classifies every individual from every group that is tpr opt and fpr opt for all a A Realizability is a widely used assumption and is the basis of seminal works such as Boosting At a high level realizability corresponds to the assumption that there is an unknown ground truth assessment rule for example in a hypothetical setting where x includes all the information that is sufficient for assessing ones qualification and the chosen set of decision rules is rich enough to contain it In static realizable applications of machine learning the goal is to approximately recover opt from data We show that in the our dynamic setting under realizability the unique non-zero equilibrium of is where individuals respond to opt Furthermore each group attains their optimal qualification rate at this equilibrium P P If there exists such that tpr and fpr for all a A then there is a unique non-zero equilibrium with a G for all a A While realizability is a common assumption in the theory of machine learning it rarely captures the subtleties that exist in automated decision making in practice Next we consider a mild relaxation of realizability and consider a setting where a near-perfect decision rule exists such that tpr and fpr As we show and prove in Appendix A when there is a single near-realizable group the main message of Proposition remains effectively the same That is all equilibria that are reachable from initial points that are not too extreme approximately maximize the groups qualification rate T E Let A and assume that p tp c FP Assume that for fixed s G is LG -Lipschitz with property that s G s s and there is such that TPR and FPR Then for any initial investment s s limn n is such that G A nice aspect of the above results is that the assumption of realizability or near-realizability can be validated from the data That is the decisionmaker can compute whether there is such that TPR and FPR If so then the decision maker can rest assured that the dynamical system is on the path towards achieving near optimal investment by the individuals Another nice aspect of these results is the characterization of the equilibria in terms of the CDF of the cost distribution This allows us to use this framework for studying interventions that change the cost function directly One such intervention is subsidizing the cost for individuals so that the cumulative distribution function of the cost given x is increased by a sufficient amount at every cost level x The following corollary proved in Appendix B shows that under this kind of subsidy the equilibria reached by the dynamics will have higher qualification rate than any fixed point of the dynamics before subsidy as long as the initial points are not too extreme As we are considering different cost distribution functions in the following corollary we denote the dynamics corresponding to cost distribution function G as G C S Let A and assume that p tp c FP Assume that for fixed s G is LG -Lipschitz with property that s G s s and there is such that TPR and FPR Let be a fixed point of the dynamics G Suppose G is a strictly increasing LG -Lipschitz CDF such that s G x s s and G x G x for all x in the domain Then for any initial investment s s there exists a such that limn n G GROUP REALIZABILITY In this section we investigate how the nature of equilibria evolves as the assumption of realizability is relaxed to allow for heterogeneity across groups specifically we consider the case where there exists a perfect assessment rule for each group but not when the groups are combined We call this group-realizability Our results illustrate that without realizability or near-realizability the utility-maximizing assessment rule can be very sensitive to the relative qualification rates in different groups resulting in multiple equilibria at which groups may experience disparate outcomes In sections and we study group-realizability under two different and complementary settings The rst setting considers features that are drawn from a multivariate Gaussian distribution and assumes that in each group the qualified individuals are perfectly separated from unqualified ones by a group-specific hyperplane This is a benign setting where no group is inherently disadvantaged group features and performance of assessment rules are symmetric up to a reparameterization of the space The second setting considers features that are uniformly distributed scalar scores and assumes that qualified and unqualified individuals in a group are separated by a group-specific threshold where one is higher than the other This model captures the natural setting where the feature score and assessment rules inherently favor one group eg SAT scores are known to be skewed by race We use the aforementioned stylized settings to demonstrate the salient characteristics of equilibria that one might anticipate under group-realizability We nd that stable equilibria tend to favor one group or the other This is especially surprising in the multivariate Gaussian case where the two groups are identical up to a change in the representation of the space We also study the existence of balanced equilibria where both groups acquire qualification at the same rate We nd that when balanced equilibria exist they tend to be unstable that is no initial qualification rate except for the balanced equilibrium itself will converge to the balanced equilibrium under the dynamics We consider two natural interventions in overcoming the challenges of group-realizability as outlined above As group-realizability poses even greater challenges when the costs of investment are unequally distributed between groups in Section we consider the impact of subsidizing the cost of acquiring qualification for one group In Section we consider the impact of decoupling that is we allow the institution to use different assessment rules for different groups assuming the group attributes are available This is in contrast to the typical setting where institutions are constrained to using the same assessment rule across all groups which may be the case when data on the protected attribute is not available or when the use of protected attributes for assessment is regulated Uniformly Distributed Scalar X We consider X the class of assessment parameters and assessment decision X for all that represent all threshold decision policies Consider two groups aa Let X be a score that is uniformly distributed over where in group ai those with score more than hi are qualified and those with score at most hi are unqualified This is depicted in Figure right Formally x Y A ai x hi hi for and x hi for Figure Equilibria in the Multivariate Gaussian case left and the Uniform case right We make the following assumption to simplify notation A We assume na p tp na c FP We also assume that the cost for acquiring qualifications is uniformly distributed on ie G c c in both groups We show that is in a certain range there are two unbalanced stable equilibria corresponding to assessment parameters or which respectively lead to the optimal qualification rate for groups a or a but low qualification rate for the other group There is also a more balanced but unstable equilibrium at some threshold between and Outside of this range of there is only one equilibrium in which one of the groups achieves its optimal qualification rate These endings are summarized in the following two propositions P define B wh wh Note that for any wl wu where wl wu Given Assumption there exists two stable equilibria at a a and a a and a unique non-zero unstable equilibrium at a a the unstable equilibrium is fully balanced P Given Assumption wl there exists one stable equilibrium defined by Equation and wu there exists one stable equilibrium defined by Equation The details of the proofs are presented in Appendix C At a high level if the wage is not too low or too high both thresholds and correspond to stable equilibria at which either group a or a is perfectly classified The equilibrium corresponding to where the classifier has the same true positive and false positive rates in both groups is unstable and subsequently harder to achieve Our results also generalize to the setting where the CDF for the cost G is an arbitrary strictly increasing function In Table we compare these equilibria in terms of metrics introduced in Section under the assumptions of Proposition We use standard notation and to denote preference and indifference respectively For example we nd that in terms of balance in qualification rates the stable equilibrium associated with is more balanced that the stable equilibrium associated with but both are always less balanced unstable equilibrium associated with Details of the computation are deferred to Table C in Appendix C Ranking of Equilibria Stability are stable is unstable qualification rate of group a qualification rate of group a Balance of qualification rates Institutions Utility no ranking Table Comparison of equilibria for uniform features In this table we refer to each equlibria using the associated threshold decision policy Multivariate Gaussian X We consider X Rd and Sd where Sd is the set of d dimensional unit vectors Let for all denote separating hyperplane policies and B kh kh denote the angle between two vectors normalized by the constant We consider two groups a and a associated respectively with vectors and such that We assume the groups have equal size ie na na For each group the feature distribution is a d-dimensional spherical Gaussian centered at the origin such that the qualified individuals are in halfspace and the unqualified individuals in halfspace Formally for x Rd and i x Y A ai x for and x for where x is the density of the spherical d-dimensional Gaussian This is depicted in Figure left A We assume that the CDF for the cost of acquiring qualifications is a strictly increasing function G and is the same in both groups As we will see the relative gain loss of the institution for accepting a qualified unqualified individual that is p TP FP plays a role in the nature of the equilibria The following proposition characterizes the equilibria when this value is strictly positive that is when the benefit of true positives outweighs the cost of false positives Notably similar to the previous setting of uniform scores the current setting also has two stable equilibria that each favor one group at the expense of the other as well as a balanced equilibrium that is unstable P Given Assumption and p tp c FP there exists two stable equilibria at a G a G a G a G There is a unique non-zero unstable equilibrium at a G a G where Let us briefly comment on the high level proof idea and defer the full argument to Appendix D Since p tp c FP the institution cares more about accepting true positives than avoiding false positives Therefore the utility-maximizing is determined by the group that has a higher qualification rate and thus has a higher fraction of positives this is whenever a a a a When qualification rates are equal between the two groups the institution maximizes its utility at any that is a convex combination of and but the unique that would induce equal qualification rate is where the classifier has the same true positive and false positive rates in both groups An unfortunate implication of this result is that the dynamics will always converge to an unbalanced qualification rate except when the initial levels of investment are exactly the same Even though a fully balanced equilibrium exists it is unstable and therefore not robust to small perturbations in either the qualification rates or the classifier which in practice is unavoidable given sampling noise In Table we compare these equilibria in terms of metrics introduced in Section For example we nd that in terms of institutional utility the stable equilibria associated with and are equally preferred and are both strictly preferred to the unstable equilibrium associated with This implies that the institution has no incentive at all to keep the dynamics at the unstable equilibrium even though it induces balanced investment Exact values are deferred to Table D in Appendix D Ranking of Equilibria Stability are stable is unstable qualification rate of group a qualification rate of group a Balance of qualification rate Institutions Utility Table Comparison of equilibria for Multivariate Gaussian features In this table we refer to each equlibria using the associated hyperplane Interestingly when p tp c FP there are no stable equilibria instead there exists a stable limit cycle between and This is stated informally in the following proposition P Given Assumption and p tp c FP there exists no stable equilibria Instead there exists a limit cycle and one nontrivial unstable equilibrium Intuitively the cycle is caused by misaligned incentives between the institution and the individuals Since the institution false positives more costly than false negatives it prefers the hyperplane that classifies more false positives correctly At each time step it will choose the hyperplane associated with the group that has a lower qualification rate prompting that group to invest more in the next time step Strikingly even a simple group-realizable model involving multivariate Gaussian distributions demonstrates a large range of limiting behaviors In Section we also observe the existence of limit cycles in simulations with real data distributions different Costs of Investment by Group Thus far we have assumed that all groups have the same distribution of the cost of investment G In reality the cost of investment may be distributed differently in each group a disadvantaged group might on average experience higher monetary or opportunity costs For example low income families who may have to take out loans to pay for college tuition incur high interest rates This is a compelling setting that reflects deep-seated disparities in access to opportunity between demographic groups in the real world an analogous setting has been considered by works on strategic classification where the costs for manipulating features is posited to differ across groups In this section we consider the ramifications of differences in investment cost across groups focusing on the setting of Section We show that the disadvantage from having higher costs is amplified under group-realizability specifically suppose that group a a has costs distributed according to cumulative distribution function G and that group a is disadvantaged in terms of costs The following result observes that if G sufficiently dominates G then there exists no stable equilibrium that encourages optimal investment from group a and no equilibrium that is balanced for both groups in sharp contrast to the characterization in Proposition The proof is deferred to Appendix E P Consider the multi-variate Gaussian setting of Section Suppose G and G are such that G G then there exists a single non-trivial equilibrium at which is also stable The level of investment by group a a is G G effect of subsidies In this situation an intervention that would effectively raise the equilibrium level of investment by the disadvantaged group is to subsidize the cost of investment In particular as long as we replace G with a stochastically dominated distribution G such that G G under the new dynamics sub will again be a stable equilibrium and there will also exist a more balanced unstable equilibrium at which is some convex combination of and At all equilibria of sub group a will have higher levels of investment than G However this improvement may come at a cost to the advantaged group since sub has multiple equilibria and some of them have group a investing less than G Still one might argue that the equilibria of sub are more equitable since the dynamics without subsidies always result in optimal investment by group a and low investment by group a Decoupling the Assessment Rule by Group The models we studied in Sections and suggest that applying the same or joint assessment rule to heterogeneous groups results in undesirable trade-offs between balance stability and other metrics at all equilibria even though there exists a perfect assessment rule for each group separately Decoupling the classifier by group is a natural intervention in this setting Namely the institution may choose a group-specific a to assess individuals from group a A assuming that the group attribute information is available This corresponds to choosing a that maximizes the utility that the institution derives from each group separately Thus we now consider the decoupled dynamics dec where the institution uses group-specific assessment rules ie for all a A bra a B argmax a p TP TPR a a a c FP FPR a a a As in the standard joint setting individuals still acquire qualification according to their group utility as follows bra a B G tpr a fpr a We denote by dec A the equilibria of the decoupled dynamics dec bra bra aA It is not hard to see that decoupling is helpful in a group-realizable setting That is the qualification rates of the decoupled equilibrium dec Pareto-dominates the qualification rates of all equilibria under a joint assessment rule whenever group-realizability holds P D Consider a group-realizable setting that is for every a A there exists a perfect assessment rule opt a such that tpr opt a fpr Then dec has a unique stable equilibrium dec where dec a G Moreover for any equilibrium of the joint dynamics dec a a for all a A Furthermore if there is no perfect assessment rule ie max X aA na tpr fpr then for some a A dec a a This proposition directly follows from Proposition Indeed decoupling always helps in the group-realizable setting not only does it not decrease any groups equilibrium qualification rate it also increases the equilibrium qualification rate of at least one group when realizability across all groups does not hold In Sections and we examine decoupling in the absence of group-realizability and see that those cases are not as clear-cut When group-realizability does not hold in some cases decoupling is still helpful while in others it can significantly harm one group BEYOND GROUP-REALIZABILITY MULTIPLE EQUILIBRIA WITHIN GROUP We have so far considered settings where the learning problem is realizable or almost realizable within each group This is a common assumption in various prior works such as Hu et al As we saw in Section there may be multiple undesirable equilibria when a joint assessment rule is used in a group-realizable setting but these undesirable equilibria disappear in the decoupled dynamics In many application domains realizability does not hold even at a group level That is to say no assessment rule in can perfectly separate qualified and unqualified individuals even within one group This may be due to the fact that mapping individuals to the visible feature space X involves loss of information or there may be other sources of stochasticity in the domain making it impossible to provide a high accuracy assessment of individuals qualifications A key consequence of the lack of realizability is that even for a single group the optimal classifier now can vary greatly with a the groups qualification rate As a result our guarantees As when we defined the joint dynamics Section when the argmax is not unique we assume ties are broken according to a fixed and well-defined order about the near-optimality of stable equilibria Theorem no longer hold and there could exist multiple stable equilibria each corresponding to a different qualification rate within a group In this section we investigate the existence of bad equilibria for a single group and its implications on decoupling when the learning problem is not group-realizable For the rest of this section we consider a single group ie A and suppress a in the notation In the following proposition proved in Appendix we characterize conditions under which multiple equilibria exists for arbitrary feature spaces and assessment rules This is a generalization of a classical result from Coate and Loury that considers a one-dimensional feature space we restate and prove the classical result as a consequence of Proposition in Appendix P M Let be as defined in Section For any qualification rate let B TPR FPR be the difference between true and false positive rates of the institutions utility maximizing assessment rule with respect to Assume is continuous the CDF of the cost G is continuous and that there exists such that PY and such that PY ie there is a assessment rule that accepts everyone and an assessment rule that rejects everyone Also suppose the likelihood ratio x Y is strictly positive on X If x G x for some x then there exists at least two distinct non-zero equilibria where If in addition is differentiable an equilibrium at is locally stable whenever G where G and denote the derivatives of G and respectively Proposition describes conditions under which there exists more than one equilibrium in the dynamics modeled in Section Given a differentiable one can always construct a monotonically increasing G such that the dynamics has any number of locally stable equilibria The implication of having multiple equilibria is that the dynamics may converge to different equilibrium qualification rates depending on the initial investment even for a single group This makes the setting particularly hard to analyze Nevertheless the following result proved in Appendix shows that even in the non-realizable setting subsidizing the cost of investment by changing the distribution G to a stochastically dominant distribution G will create a new equilibrium that has a higher qualification rate In other words subsidies in the non-realizable setting also improve the quality of equilibria However the new equilibrium is not guaranteed to be locally stable We see some ramifications of this empirically in the next section P S Suppose is an equilibrium for the dynamics G where the cost of investment is distributed according to G on Let G be a CDF that is stochastically dominated by G that is G x G x for all x and both G and G are strictly increasing Then there exists such that is an equilibrium for G SIMULATIONS WITH NON-REALIZABILITY In this section we present results from numerical experiments examining the effects of decoupling and subsidies under our model of dynamics in the absence of group-realizability We consider a stylized semi-synthetic experiment based on a widely used FICO credit score dataset from a Federal Reserve report Importantly only aggregate statistics were reported and the data we accessed does not contain sensitive or private information Our modeling assumptions may not be realistic for this dataset see Section and our simulations should not be interpreted as policy recommendations Instead these experiments help us illustrate qualitatively the types of dynamics one may nd using real world data Stylized Model We describe how our model can be instantiated to a highly stylized example of credit scoring and lending Assume a loan applicant either has the means to repay a loan or not If they have the means to repay they always repay Y otherwise they always default Y In order to have the means to repay applicants must make an ex ante investment at the cost whose distribution is PC c G c This represents costly actions an individual has to take in order to acquire the financial ability to repay loans eg working at a stable job or taking job preparation classes Applicants from group a who have the means to repay receive credit scores X drawn from a and those who dont receive credit scores drawn from a The decision of the bank is to approve or reject a loan applicant given their credit scores Dataset FICO scores are widely used in the United States to predict credit worthiness The dataset which contains aggregate statistics is based on a sample of TransUnion TransRisk scores from and has been preprocessed by Hardt et al These scores corresponding in our model range from to For simplicity we rescale the scores so that they are between and Individuals were labeled as defaulted if they failed to pay a debt for at least days on at least one account in the ensuing month period The data is also labeled by race which is the group attribute A that we use We compute empirical conditional feature distributions x A aY from the available data and t Beta distributions to these to obtain a a We treat these distributions as if they came from our model as shown in Figure for the sole purpose of illustration This is not to claim that our modeling assumptions hold on this dataset as discussed earlier Given the lending domain is complex our aim is not to faithfully represent this particular domain with our model but to simulate feature distributions that exhibit group heterogeneity and non-realizability hence extending our consideration beyond the idealized settings of Sections and Figure shows the histograms as well as the fitted Beta distributions for a a where a is the race attribute It is clear that group-realizability does not hold even approximately since there is significant overlap in the distributions of credit scores for people who repaid and for people who did not repay Decoupling and Multiple Stable Equilibria Although decoupling is guaranteed to improve the qualification rate at equilibrium over using a joint decision rule for every group Sections and this is not necessarily true in the non-realizable setting In fact even when G is the uniform distribution on in all groups ie the cost of investment C is uniformly distributed on as we considered in Section decoupling did not benefit We simulate samples from the empirical PDF see Figure and t a Beta distribution by maximum likelihood estimation Figure Score distributions conditioning on repayment outcome Y for different race groups Improvement in final qualification rate after decoupling Initial qualification rate Improvement in final qualification rate after decoupling Initial qualification rate Figure effects of decoupling in presence of multiple equilibria We vary the initial qualification rate in the x-axis all groups As can be seen from Figure G in Appendix G while the White and Asian groups had a higher qualification rate after decoupling the Black and Hispanic groups saw their equilibrium qualification rate decrease On the other hand the effects of decoupling were small in this case less than percent points difference in the final qualification rate We now show that the effect of decoupling can be drastic depending on G Recall that in Section we showed that multiple equilibria with possibly vastly different qualification rates may exist under the non-realizable setting even when there is a only single group In general the existence of multiple equilibria depends on properties that is how the cost of investment is distributed in a group In Figure we show the change in equilibrium investment level after decoupling for an experiment with two groups Asian and Hispanic The two plots each correspond to a different bimodal Gaussian distribution for G truncated to that have been chosen such that the decoupled dynamics have multiple stable equilibria for the Hispanic right and the Asian left respectively In both plots we can see that the effects of decoupling depend on the initial qualification rate If the initial qualification rate was too low or too high the decoupled dynamics converge to an equilibrium where one of the groups invest in qualifications at a much lower level than they would under the joint dynamics The right left plot is generated using a bimodal normal distribution with modes at and at and See Figure G in Appendix G for the converged qualification rates of both groups na l q ca n ra te Subsidizing one group under joint and decoupled dynamics Black joint Black decoupled White joint White decoupled Asian joint Asian decoupled Hispanic joint Hispanic decoupled Figure effects of raising the average cost of investment by varying the mean of G on the x-axis Subsidizing the Cost of Investment In this experiment we consider if subsidizing the cost of investment of one group by changing G improves their new equilibrium qualification rate under both decoupled and joint dynamics specifically we vary the cost of investment in the Black group We use a truncated normal distribution for G and vary its mean on the x-axis for a single group while keeping the other groups G unchanged mean of Figure shows that subsidizing the cost of investment is effective in raising the equilibrium investment level of a group both in the joint learning and decoupled learning case Interestingly large amounts of subsidy for a single group reduced the equilibrium investment levels of other groups As also suggested by theoretical results in section subsidizing the qualification rate of one group does sometimes entail a tradeoff in the qualification rates of other possibly more advantaged groups Interestingly lowering the mean cost of investment in the Black group below caused the final qualification rate to decrease This is not a contradiction of Proposition which argues that equilibria improve under subsidies but does not guarantee that the dynamics will converge to the improved equilibrium In this case the decoupled dynamics for the Black group where the mean cost of investment is actually converged to a limit cycle and the final qualification rate in the plot is an average of the points in the limit cycle Limit cycles are a challenging object to study in dynamical systems and game theory While we have commented on their existence in a simple model in group-realizable setting of Section we leave their implications in the general non-realizable setting to future work RELATEDWORK Our work follows a growing line of work on how machine learning algorithms interact with human actors in a dynamic setting with the goal of understanding and mitigating disparate impact Recent work examine the long-term impact of group fairness criteria see eg Chapter on automated decision making systems Liu et al show that static fairness criteria fail to account for the delayed impact that decisions have on the welfare of disadvantaged groups In the context of hiring however Hu and Chen nd that applying the demographic parity constraint in a temporary labor market achieves an equitable long-term equilibrium in the permanent labor market by raising worker reputations Prior work on the fairness of machine learning has examined trade-offs between fairness criteria as well as the incompatibility between risk minimization and fairness criteria assuming that the qualification rates differ across groups These results concern the static setting whereas we highlight the fact that qualification rates tend to change in response to the decision rules Another line of work analyzes a dynamic model where users respond to errors made by an institution by leaving the user base uniformly at random and demonstrate how the risk-minimizing approach to machine learning can amplify representation disparity over time This is complementary to our work which models individuals as rational decision makers who may or may not have the incentive to acquire the positive label In particular Hashimoto et al show that equilibria with equal user representation from all groups can be unstable and that robust learning can stabilize such equilibria Unlike in our model the user representation model does not distinguish between positive and negative labels and thus do not distinguish between false negative and false positive errors This is a crucial distinction in high-stakes decision making as different error types present asymmetric incentives for individuals as explained in Section for example a high false positive rate in hiring would encourage under-qualified job applicants Hu et al and Milli et al study the disparate impact of being robust towards strategic manipulation see eg where individuals respond to machine learning systems by manipulating their features to get a better classification In contrast to our model Figure their setting models the individual as intervening directly on their features X and this is assumed to have no effect on their qualification Y This assumption applies to features that are easy to game eg scores on standardized tests can be improved by test preparation classes but is less applicable to features that more directly correspond to investment in ones qualifications eg taking AP courses in high school Hu et al also show that subsidizing the costs of the disadvantaged group to strategically manipulate their features can sometimes lead to harmful effects Kleinberg and Raghavan and Khajehnejad et al study decision policies that incentivize individuals to directly manipulate their features X to optimize particular notions of utility Our work is also related to the topic of statistical discrimination in economics which studies how disparate market outcomes at equilibrium can arise from imperfect information This line of work often involves wage discrimination whereas we assume the wage is fixed and standard for all groups Coate and Loury proposed a model of rational individual investment in the labor market under a fixed wage and showed that armative action may lead to an undesirable equilibrium where one group still invests sub-optimally The model in our work is most closely related to their model with two key distinctions We allow features X to be multi-dimensional whereas Coate and Loury assumes that X is a one-dimensional noisy signal We consider the case where the conditional feature distributions x Y A a differ by groups whereas Coate and Loury assumes that the groups are identically distributed Under our models if the conditional feature distributions were shared across groups then any hiring policy will result in fully balanced equilibria where all groups have the same qualification rate and are hired at the same rate This does not corroborate with reality where conditional feature distributions do in fact differ across groups and we routinely observe institutions applying the same model to all individuals only to see obviously discriminatory outcomes By modeling feature heterogeneity across groups we nd it necessarily leads to disparate equilibria Recently Mouzannar et al studied the equilibria of qualification rates under a generic class of dynamics focusing on contractive maps and the effects of armative action In contrast our work motivates a model of dynamics based on rational investment and this typically leads to non-contractive dynamics We are both interested in balanced equilibria which they termed social equality Finally our work studies two interventions for ending more desirable equilibria decoupling the classifier and subsidizing the cost of investment Several works including Dwork et al and Ustun et al have studied decoupled classifiers in the static classification setting Our work sheds light on when such interventions are useful in the dynamic decision making setting DISCUSSION AND FUTURE WORK In this work we have made the following contributions We proposed a dynamic model of decision making where individuals invest rationally based on the current assessment rule We studied the properties of equilibria under these dynamics We showed that common properties of real data namely heterogeneity across groups and the lack of realizability lead to undesirable trade-offs at equilibria resulting in long term outcomes that disadvantage one or more groups We considered two interventions decoupling and subsidizing the cost of investment and showed that they have a significant impact on the nature of equilibria both in theory and in numerical experiments We now discuss the limitations of the current work and avenues for future research Questions related to sampling and its ramifications for the nature of equilibria are challenging and warrant further study This work assumed that the institution can estimate the true and false positive rates over the entire population even though it really can only observe the qualification of candidates after hiring them This is known as the selective labeling problem which could introduce bias In theory unbiased estimates can be achieved by a small degree of random sampling and appropriate reweighting see eg but this is still a large problem in practice that requires domain-specific knowledge and solutions Our model assumed that individuals make a rational decision to invest and can affect their qualification Y directly This assumption could be reasonable in settings like hiring for example where investing to acquire skills usually leads to increased competence In some settings however individuals may be unable to effectively intervene For example a business loan applicant who is a good business operator could still default on their loan due to external economic shocks or other forms of disadvantage that have not been taken into account In this case the current model does not fully capture the complex societal processes that lead to a positive outcome Our work nonetheless shows that even in an idealized setting where individuals can effectively and rationally intervene on their outcome labels Y underlying factors such as heterogeneity across groups and non-realizability already lead to undesirable trade-offs at equilibrium We leave the extensions of the current model beyond rational individual investment to future work